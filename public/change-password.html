<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Change Password</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #222;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  .container {
    background: rgba(255 255 255 / 0.1);
    padding: 30px;
    border-radius: 15px;
    backdrop-filter: blur(10px);
    width: 320px;
  }
  input[type="password"], button {
    width: 100%;
    padding: 10px;
    margin: 12px 0;
    border-radius: 8px;
    border: none;
    font-size: 16px;
  }
  button {
    background: #4CAF50;
    color: white;
    cursor: pointer;
  }
  button:hover {
    background: #45a049;
  }
  .message {
    margin-top: 15px;
    font-weight: bold;
  }
</style>
</head>
<body>

<div class="container">
  <h2>Change Password</h2>
  <form id="changePasswordForm">
    <input type="password" id="currentPassword" placeholder="Current Password" required />
    <input type="password" id="newPassword" placeholder="New Password" required />
    <input type="password" id="confirmPassword" placeholder="Confirm New Password" required />
    <button type="submit">Change Password</button>
  </form>
  <div class="message" id="message"></div>
</div>

<script>
  const loggedUser = localStorage.getItem("loggedUser");
  if (!loggedUser) {
    window.location.href = "login.html";
  }

  const form = document.getElementById("changePasswordForm");
  const messageDiv = document.getElementById("message");

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const currentPasswordInput = document.getElementById("currentPassword").value.trim();
    const newPasswordInput = document.getElementById("newPassword").value.trim();
    const confirmPasswordInput = document.getElementById("confirmPassword").value.trim();

    const storedPassword = localStorage.getItem("password_" + loggedUser);

    // Check current password
    if (currentPasswordInput !== storedPassword) {
      messageDiv.style.color = "red";
      messageDiv.textContent = "Current password is incorrect.";
      return;
    }

    // Check new password length
    if (newPasswordInput.length < 6) {
      messageDiv.style.color = "red";
      messageDiv.textContent = "New password must be at least 6 characters.";
      return;
    }

    // Check new passwords match
    if (newPasswordInput !== confirmPasswordInput) {
      messageDiv.style.color = "red";
      messageDiv.textContent = "New passwords do not match.";
      return;
    }

    // Save new password
    localStorage.setItem("password_" + loggedUser, newPasswordInput);
    messageDiv.style.color = "lightgreen";
    messageDiv.textContent = "Password changed successfully.";

    // Optional: clear inputs
    form.reset();
  });
</script>

</body>
</html>